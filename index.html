<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EPTEC MASTER CONTROL</title>

  <link rel="stylesheet" href="assets/style.css">
  <link rel="stylesheet" href="assets/ui_elements.css">
  <link rel="stylesheet" href="assets/imagine.css">
  <link rel="stylesheet" href="assets/hidden.css">

  <style>
    /* Desktop safety */
    #meadow-view { display: flex !important; }
    .tunnel-active { filter: brightness(2) blur(15px); pointer-events: none; }

    /* ---- WIESE: pure CSS ---- */
    #meadow-view.grassy-meadow{
      position: fixed;
      inset: 0;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      background:
        radial-gradient(1200px 700px at 70% 20%, rgba(255,255,255,.55), rgba(255,255,255,0) 60%),
        radial-gradient(900px 600px at 20% 15%, rgba(255,255,255,.35), rgba(255,255,255,0) 55%),
        linear-gradient(to bottom,
          #87ceeb 0%,
          #cfefff 35%,
          #f6fbff 45%,
          #70c46a 46%,
          #4ea24a 100%);
    }
    #meadow-view.grassy-meadow::before{
      content:"";
      position:absolute;
      inset:0;
      background:
        repeating-linear-gradient(90deg, rgba(0,0,0,.04) 0 1px, rgba(0,0,0,0) 1px 8px),
        repeating-linear-gradient(0deg, rgba(0,0,0,.03) 0 1px, rgba(0,0,0,0) 1px 10px);
      opacity:.25;
      pointer-events:none;
      transform: translateY(46%);
    }
    #meadow-view.grassy-meadow::after{
      content:"";
      position:absolute;
      left:-10%;
      right:-10%;
      top:42%;
      height:20%;
      background: radial-gradient(closest-side, rgba(255,255,255,.55), rgba(255,255,255,0));
      opacity:.65;
      pointer-events:none;
    }

    /* ---- Make UI readable ---- */
    .entry-btn { min-height: 44px; padding: 10px 16px; font-size: 16px; border-radius: 12px; }
    .entry-input { min-height: 44px; padding: 10px 14px; font-size: 16px; border-radius: 12px; }
    .legal-footer { display:flex; justify-content:center; align-items:center; gap:10px; padding: 10px 12px; }
    .legal-link { cursor:pointer; text-decoration: underline; }

    /* ---- FLAG CANNON ---- */
    .lang-switcher{
      position: fixed;
      top: 14px;
      right: 14px;
      z-index: 999999;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 10px;
      user-select: none;
    }
    #lang-toggle{
      width: 48px;
      height: 48px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.35);
      background: rgba(0,0,0,.22);
      backdrop-filter: blur(10px);
      cursor: pointer;
      display: grid;
      place-items: center;
      font-size: 20px;
      line-height: 1;
      color: white;
    }
    #lang-rail{
      display: flex;
      align-items: center;
      gap: 8px;
      transform-origin: right center;
      transform: translateX(12px) scaleX(0);
      opacity: 0;
      pointer-events: none;
      transition: transform 220ms ease, opacity 220ms ease;
    }
    .lang-open #lang-rail{
      transform: translateX(0) scaleX(1);
      opacity: 1;
      pointer-events: auto;
    }
    .lang-item{
      width: 46px;
      height: 46px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.25);
      background: rgba(0,0,0,.20);
      backdrop-filter: blur(10px);
      cursor: pointer;
      display: grid;
      place-items: center;
      font-size: 16px;
      line-height: 1;
      transition: transform 160ms ease, background 160ms ease;
      color: white;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .lang-item:hover{ transform: translateY(-2px); background: rgba(0,0,0,.32); }
  </style>
</head>

<body>

  <!-- SYSTEM HEADER -->
  <header class="app-header">
    <h1 id="app-title">Contract Office</h1>
    <div id="app-subtitle">by Johannes B√ºngener</div>
    <div id="system-clock"></div>
  </header>

  <!-- LANGUAGE SWITCHER -->
  <div id="language-switcher" class="lang-switcher" aria-label="Language">
    <div id="lang-rail" aria-hidden="true">
      <button class="lang-item" type="button" data-lang="en">EN</button>
      <button class="lang-item" type="button" data-lang="de">DE</button>
      <button class="lang-item" type="button" data-lang="es">ES</button>
      <button class="lang-item" type="button" data-lang="fr">FR</button>
      <button class="lang-item" type="button" data-lang="it">IT</button>
      <button class="lang-item" type="button" data-lang="pt">PT</button>
      <button class="lang-item" type="button" data-lang="nl">NL</button>
      <button class="lang-item" type="button" data-lang="ru">RU</button>
      <button class="lang-item" type="button" data-lang="uk">UA</button>
      <button class="lang-item" type="button" data-lang="ar">AR</button>
      <button class="lang-item" type="button" data-lang="zh">ZH</button>
      <button class="lang-item" type="button" data-lang="ja">JA</button>
    </div>
    <button id="lang-toggle" type="button">üåê</button>
  </div>

  <!-- MEADOW / LOGIN -->
  <section id="meadow-view" class="grassy-meadow">
    <div id="entry-ui" class="entry-ui">

      <input id="login-username" class="entry-input" autocomplete="username">
      <input id="login-password" class="entry-input" type="password" autocomplete="current-password">

      <div class="entry-actions">
        <button id="btn-login" class="entry-btn"></button>
        <button id="btn-register" class="entry-btn"></button>
        <button id="btn-forgot" class="entry-btn"></button>
      </div>

      <div id="login-message" class="system-msg"></div>

      <div id="admin-gate" class="admin-gate">
        <input id="admin-code" class="entry-input" autocomplete="off">
        <button id="admin-submit" class="entry-btn"></button>
      </div>
    </div>

    <div id="legal-footer" class="legal-footer">
      <span id="link-imprint" class="legal-link"></span>
      <span>|</span>
      <span id="link-terms" class="legal-link"></span>
      <span>|</span>
      <span id="link-support" class="legal-link"></span>
      <span>|</span>
      <span id="link-privacy-footer" class="legal-link"></span>
    </div>
  </section>

  <!-- REGISTER -->
  <section id="register-screen" class="modal modal-hidden">
    <div class="modal-card register-card">
      <div id="register-title" class="modal-title"></div>
      <input id="reg-first-name" class="entry-input">
      <input id="reg-last-name" class="entry-input">
      <input id="reg-birthdate" class="entry-input">
      <input id="reg-email" class="entry-input">
      <input id="reg-username" class="entry-input">
      <input id="reg-password" class="entry-input" type="password">
      <div id="reg-rules-username" class="rule-text"></div>
      <div id="reg-rules-password" class="rule-text"></div>
      <div id="register-message" class="system-msg"></div>
      <button id="reg-submit" class="entry-btn locked"></button>
      <button id="reg-close" class="entry-btn secondary"></button>
    </div>
  </section>

  <!-- FORGOT -->
  <section id="forgot-screen" class="modal modal-hidden">
    <div class="modal-card forgot-card">
      <div id="forgot-title" class="modal-title"></div>
      <input id="forgot-identity" class="entry-input">
      <div id="forgot-message" class="system-msg"></div>
      <button id="forgot-submit" class="entry-btn"></button>
      <button id="forgot-close" class="entry-btn secondary"></button>
    </div>
  </section>

  <!-- LEGAL -->
  <section id="legal-screen" class="modal modal-hidden">
    <div class="modal-card">
      <div id="legal-title" class="modal-title"></div>
      <div id="legal-body" style="white-space:pre-wrap;"></div>
      <button id="legal-close" class="entry-btn secondary"></button>
    </div>
  </section>

  <!-- ROOM 1 -->
  <section id="room-1-view" style="display:none;">
    <div class="engraved-matrix"></div>
  </section>

  <!-- ROOM 2 DASHBOARD -->
  <section id="room-2-view" style="display:none;">
    <div style="padding:40px;color:white;max-width:900px;margin:0 auto;">

      <h2>Dashboard</h2>

      <div id="coupling-banner" class="system-msg" style="display:none;"></div>

      <div>
        <strong>Construction:</strong>
        <span id="construction-status">‚Äî</span>
        /
        <span id="construction-tier">‚Äî</span>
      </div>

      <div>
        <strong>Controlling:</strong>
        <span id="controlling-status">‚Äî</span>
        /
        <span id="controlling-tier">‚Äî</span>
      </div>

      <div id="referral-code-block" style="display:none;margin-top:20px;">
        <div id="referral-code-value">‚Äî</div>
        <button id="referral-copy" class="entry-btn">Kopieren</button>
      </div>

      <div style="margin-top:20px;">
        <input id="present-code-input" class="entry-input">
        <button id="present-activate-btn" class="entry-btn">Aktivieren</button>
        <div id="present-status" class="system-msg"></div>
      </div>

      <div style="margin-top:20px;">
        <span>N√§chste Abrechnung:</span>
        <strong id="next-invoice-date">‚Äî</strong>
        <span id="next-invoice-discount"></span>
      </div>

    </div>
  </section>

  <!-- EFFECTS -->
  <div id="eptec-white-flash" class="white-flash-hidden"></div>
  <div id="eptec-tunnel" class="tunnel-hidden">
    <div class="tunnel-wall"></div>
  </div>

  <!-- SCRIPTS -->
  <script src="scripts/sounds.js" defer></script>
  <script src="scripts/ui_state.js" defer></script>
  <script src="scripts/ui_controller.js" defer></script>
  <script src="scripts/registration_engine.js" defer></script>
  <script src="scripts/mock_backend.js" defer></script>
  <script src="scripts/state_manager.js" defer></script>
  <script src="scripts/logic.js" defer></script>
  <script src="scripts/main.js" defer></script>

</body>
</html>
